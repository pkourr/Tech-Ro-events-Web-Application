<!doctype html>
<html class="modern fixed has-top-menu has-left-sidebar-half">
	<head>

		<!-- Basic -->
		<meta charset="UTF-8">

		<title>Event Details | Tech-Ro Admin</title>
		<meta name="keywords" content="Tech Events" />
		<meta name="description" content="Tech-Ro | Your choice for Tech Events!">
		<meta name="author" content="tech-ro.com">

		<!-- Favicon -->
		<link rel="apple-touch-icon" sizes="180x180" href="../img/favicon/apple-touch-icon.png">
		<link rel="icon" type="image/png" sizes="32x32" href="../img/favicon/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="../img/favicon/favicon-16x16.png">
		<link rel="manifest" href="../img/favicon/site.webmanifest">

		<!-- Mobile Metas -->
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

		<!-- Web Fonts  -->
		<link href="https://fonts.googleapis.com/css?family=Poppins:100,300,400,600,700,800,900" rel="stylesheet" type="text/css">

		<!-- Vendor CSS -->
		<link rel="stylesheet" href="vendor/bootstrap/css/bootstrap.css" />
		<link rel="stylesheet" href="vendor/animate/animate.compat.css">
		<link rel="stylesheet" href="vendor/font-awesome/css/all.min.css" />
		<link rel="stylesheet" href="vendor/boxicons/css/boxicons.min.css" />
		<link rel="stylesheet" href="vendor/magnific-popup/magnific-popup.css" />
		<link rel="stylesheet" href="vendor/bootstrap-datepicker/css/bootstrap-datepicker3.css" />
		<link rel="stylesheet" href="vendor/select2/css/select2.css" />
		<link rel="stylesheet" href="vendor/select2-bootstrap-theme/select2-bootstrap.min.css" />

		<!--darkmode btn-->
		<link rel="stylesheet" href="../vendor/fontawesome-free/css/all.min.css">
		<link rel="stylesheet" href="../vendor/fontawesome-free/css/all.css">
		<link rel="stylesheet" href="../css/theme-elements.css" />

		<!-- Theme CSS -->
		<link rel="stylesheet" href="css/theme.css" />

		<!-- Theme Layout -->
		<link rel="stylesheet" href="css/layouts/modern.css" />

		<!-- Skin CSS -->
		<link rel="stylesheet" href="css/skins/default.css" />

		<!-- Theme Custom CSS -->
		<link rel="stylesheet" href="css/custom.css">

		<!-- Head Libs -->
		<script src="vendor/modernizr/modernizr.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
		<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
		<!--Session check or redirect-->
		<script>
			$(document).ready(function() {
				// Check if admin is logged in
				$.get('/check-admin-session', function(data) {
					if (!data.loggedIn) {
						// If admin is not logged in, redirect to login page
						window.location.href = '/admin/page-admin-sign-in.html';
					}
				});
			});
		</script>
		<!--Dark Mode check and implement-->
		<script>
			$(document).ready(function() {
				// Get the saved dark mode state from LocalStorage, if it exists
				var darkMode = localStorage.getItem('darkMode');

				// If darkMode exists and is 'true', add the .dark class and check the switch
				if (darkMode === 'true') {
					$('html').addClass('dark');
					$('#darkModeBtn').prop('checked', true);
				}

				// Listen for switch state changes
				$('#darkModeBtn').change(function() {
					// If the switch is checked, add the .dark class and save the state
					if ($(this).is(':checked')) {
						$('html').addClass('dark');
						localStorage.setItem('darkMode', 'true');
					}
					// If the switch is not checked, remove the .dark class and save the state
					else {
						$('html').removeClass('dark');
						localStorage.setItem('darkMode', 'false');
					}
				});
			});
		</script>
		<!--Logout Button-->
		<script>
			$(document).ready(function() {
				$('#adminLogout').click(function(event) {
					// Prevent the default action
					event.preventDefault();

					$.post('/admin-logout', function(data) {
						// If the server responds successfully, redirect to the login page
						window.location.href = 'page-admin-sign-in.html';
					});
				});
			});
		</script>

	</head>
	<body>
		<section class="body">

			<!-- start: header -->
			<header class="header header-nav-menu header-nav-links">
				<div class="logo-container">
					<a href="../index-one-page.html" class="logo">
						<img src="../img/tech-ro-low-resolution-logo-color-on-transparent-background.png" class="logo-image" width="90" height="50" alt="Porto Admin" /><img src="../img/logo_transparent_blacktxt.png" class="logo-image-mobile" width="90" height="51" alt="Porto Admin" />
					</a>
					<button class="btn header-btn-collapse-nav d-lg-none" data-bs-toggle="collapse" data-bs-target=".header-nav">
						<i class="fas fa-bars"></i>
					</button>
				</div>

				<!-- start: user box -->
				<div class="header-right">

					<span class="separator"></span>
					<label class="form-check-label" for="darkModeBtn"><i class="fa-sharp fa-solid fa-circle-half-stroke fa-spin fa-spin-reverse fa-xl" style="color: #464f5d;"></i></label>
					<input id="darkModeBtn" type="checkbox" name="darkModeBtn" class="gdpe-input custom-checkbox-switch mb-1" value="darkmode" />
					<div id="userbox" class="userbox">
						<a href="#" data-bs-toggle="dropdown">

							<span class="profile-picture profile-picture-as-text">A</span>
							<div class="profile-info profile-info-no-role" data-lock-name="John Doe" data-lock-email="johndoe@okler.com">
								<span class="name">Hi, <strong id="adminUser" class="font-weight-semibold">Admin</strong></span>
							</div>

							<i class="fas fa-chevron-down text-color-dark"></i>
						</a>

						<div class="dropdown-menu">
							<ul class="list-unstyled">
								<li>
									<a role="menuitem" tabindex="-1" href="page-admin-dashboard.html"><i class="bx bx-user"></i> My Dashboard</a>
								</li>
								<li>
									<a id="adminLogout" role="menuitem" tabindex="-1" href="page-admin-sign-in.html"><i class="bx bx-log-out"></i> Logout</a>
								</li>
							</ul>
						</div>
					</div>
				</div>
				<!-- end: search & user box -->
			</header>
			<!-- end: header -->

			<div class="inner-wrapper">
				<!-- start: sidebar -->
				<aside id="sidebar-left" class="sidebar-left">

					<div class="sidebar-header">
						<div class="sidebar-toggle d-none d-md-flex" data-toggle-class="sidebar-left-collapsed" data-target="html" data-fire-event="sidebar-left-toggle">
							<i class="fas fa-bars" aria-label="Toggle sidebar"></i>
						</div>
					</div>

					<div class="nano">
						<div class="nano-content">
							<nav id="menu" class="nav-main" role="navigation">

								<ul class="nav nav-main">
									<li>
										<a class="nav-link" href="page-admin-dashboard.html">
											<i class="bx bx-home-alt" aria-hidden="true"></i>
											<span>Dashboard</span>
										</a>
									</li>
									<li class="nav-group-label">Admin Menu</li>
									<li class="nav-parent nav-expanded nav-active">
										<a class="nav-link" href="#">
											<i class="bx bx-cart-alt" aria-hidden="true"></i>
											<span>Actions</span>
										</a>
										<ul class="nav nav-children">
											<li>
												<a class="nav-link" href="page-admin-dashboard.html">
													- Dashboard
												</a>
											</li>
											<li>
												<a class="nav-link" href="page-admin-user-list.html">
													- User List
												</a>
											</li>
											<li>
												<a class="nav-link" href="page-admin-campaign-edit.html">
													- Campaign Edit
												</a>
											</li>
											<li class="nav-active">
												<a class="nav-link" href="page-admin-event-list.html">
													- Event List
												</a>
											</li>
										</ul>
									</li>
									<li>
										<a class="nav-link" href="mailbox-folder.html">
											<i class="bx bx-envelope" aria-hidden="true"></i>
											<span>Mailbox</span>
										</a>
									</li>
								</ul>
							</nav>
						</div>
						<script>
							// Maintain Scroll Position
							if (typeof localStorage !== 'undefined') {
								if (localStorage.getItem('sidebar-left-position') !== null) {
									var initialPosition = localStorage.getItem('sidebar-left-position'),
											sidebarLeft = document.querySelector('#sidebar-left .nano-content');

									sidebarLeft.scrollTop = initialPosition;
								}
							}
						</script>
					</div>

				</aside>
				<!-- end: sidebar -->

				<section role="main" class="content-body content-body-modern mt-0">
					<header class="page-header page-header-left-inline-breadcrumb">
						<h2 class="font-weight-bold text-6">Event Details</h2>
						<div class="right-wrapper">
							<ol class="breadcrumbs">

								<li><span>Home</span></li>

								<li><span>Dashboard</span></li>

								<li><span>Events</span></li>

							</ol>
						</div>
					</header>

					<!-- start: page -->
					<form class="order-details action-buttons-fixed" method="post">
<!--						<div class="row">-->
<!--							<div class="col-xl-4 mb-4 mb-xl-0">-->

<!--								<div class="card card-modern">-->
<!--									<div class="card-header">-->
<!--										<h2 class="card-title">General</h2>-->
<!--									</div>-->
<!--									<div class="card-body">-->

<!--										<div class="form-row">-->
<!--											<div class="form-group col mb-3">-->
<!--												<label>Date Created</label>-->
<!--												<div class="date-time-field">-->
<!--													<div class="date">-->
<!--														<input type="text" class="form-control form-control-modern" name="orderDate" value="2019-11-21" required data-plugin-datepicker data-plugin-options='{"orientation": "bottom", "format": "yyyy-mm-dd"}' />-->
<!--													</div>-->
<!--													<div class="time">-->
<!--														<span class="px-2">@</span>-->
<!--														<input type="text" class="form-control form-control-modern text-center" name="orderTimeHour" value="10" required />-->
<!--														<span class="px-2">:</span>-->
<!--														<input type="text" class="form-control form-control-modern text-center" name="orderTimeMin" value="28" required />-->
<!--													</div>-->
<!--												</div>-->
<!--											</div>-->
<!--										</div>-->
<!--										<div class="form-row">-->
<!--											<div class="form-group col mb-3">-->
<!--												<label>Customer</label>-->
<!--												<select class="form-control form-control-modern" name="orderCustomer" required data-plugin-selectTwo>-->
<!--													<option value="21" selected>John Doe</option>-->
<!--													<option value="33">Monica Doe</option>-->
<!--													<option value="55">Robert Doe</option>-->
<!--													<option value="60">Tim Doe</option>-->
<!--												</select>-->
<!--											</div>-->
<!--										</div>-->
<!--									</div>-->
<!--								</div>-->

<!--							</div>-->
<!--							<div class="col-xl-8">-->

<!--								<div class="card card-modern">-->
<!--									<div class="card-header">-->
<!--										<h2 class="card-title">Addresses</h2>-->
<!--									</div>-->
<!--									<div class="card-body">-->
<!--										<div class="row">-->
<!--											<div class="col-xl-auto me-xl-5 pe-xl-5 mb-4 mb-xl-0">-->
<!--												<h3 class="text-color-dark font-weight-bold text-4 line-height-1 mt-0 mb-3">BILLING</h3>-->
<!--												<ul class="list list-unstyled list-item-bottom-space-0">-->
<!--													<li>Street Name Example</li>-->
<!--													<li>1234</li>-->
<!--													<li>Detroit</li>-->
<!--													<li>Michigan</li>-->
<!--													<li>93218</li>-->
<!--													<li>USA</li>-->
<!--												</ul>-->
<!--												<strong class="d-block text-color-dark">Email address:</strong>-->
<!--												<a href="mailto:johndoe@domain.com">johndoe@domain.com</a>-->
<!--												<strong class="d-block text-color-dark mt-3">Phone:</strong>-->
<!--												<a href="tel:+5551234" class="text-color-dark">555-1234</a>-->
<!--											</div>-->
<!--											<div class="col-xl-auto ps-xl-5">-->
<!--												<h3 class="font-weight-bold text-color-dark text-4 line-height-1 mt-0 mb-3">SHIPPING</h3>-->
<!--												<ul class="list list-unstyled list-item-bottom-space-0">-->
<!--													<li>Street Name Example</li>-->
<!--													<li>1234</li>-->
<!--													<li>Detroit</li>-->
<!--													<li>Michigan</li>-->
<!--													<li>93218</li>-->
<!--													<li>USA</li>-->
<!--												</ul>-->
<!--												<strong class="d-block text-color-dark">Email address:</strong>-->
<!--												<a href="mailto:johndoe@domain.com">johndoe@domain.com</a>-->
<!--												<strong class="d-block text-color-dark mt-3">Phone:</strong>-->
<!--												<a href="tel:+5551234" class="text-color-dark">555-1234</a>-->
<!--											</div>-->
<!--										</div>-->
<!--									</div>-->
<!--								</div>-->

<!--							</div>-->
<!--						</div>-->
						<div class="row mt-2">
							<div class="col">
								<section class="card card-modern card-big-info">
									<div class="card-body">
										<div class="row">
											<div class="col-lg-2-5 col-xl-1-5">
												<i class="card-big-info-icon bx bx-box"></i>
												<h2 class="card-big-info-title">Event Info</h2>
												<p class="card-big-info-desc">Add here all the event info required to take place.</p>
											</div>
											<div class="col-lg-3-5 col-xl-4-5">
												<div class="form-group row align-items-center pb-3">
													<label class="col-lg-5 col-xl-3 control-label text-lg-end mb-0">Event Name</label>
													<div class="col-lg-7 col-xl-6">
														<input id="eventName" type="text" class="form-control form-control-modern" name="eventName" value="" required />
													</div>
												</div>
												<div class="form-group row">
													<label class="col-lg-5 col-xl-3 control-label text-lg-end pt-2 mt-1 mb-0">Event Description</label>
													<div class="col-lg-7 col-xl-6">
														<textarea id="eventDescription" class="form-control form-control-modern" name="eventDescription" rows="6"></textarea>
													</div>
												</div>
												<div class="form-group row">
													<label class="col-lg-5 col-xl-3 control-label text-lg-end pt-2 mt-1 mb-0">Date Created</label>
													<div class="col-lg-7 col-xl-6 date-time-field">
														<div class="date">
															<input id="eventDate" type="text" class="form-control form-control-modern" name="eventDate" value="2023-11-21" required data-plugin-datepicker data-plugin-options='{"orientation": "bottom", "format": "yyyy-mm-dd"}' />
														</div>
														<div class="time">
															<span class="px-2">@</span>
															<input id="eventHour" type="text" class="form-control form-control-modern text-center" name="eventHour" value="10" required />
															<span class="px-2">:</span>
															<input id="eventMinute" type="text" class="form-control form-control-modern text-center" name="eventMinute" value="28" required />
														</div>
													</div>
												</div>
												<div class="form-group row align-items-center pb-3">
													<label class="col-lg-5 col-xl-3 control-label text-lg-end mb-0">Latitude</label>
													<div class="col-lg-7 col-xl-6">
														<input id="eventLatitude" type="text" class="form-control form-control-modern" name="latitude" value="" required />
													</div>
												</div>
												<div class="form-group row align-items-center pb-3">
													<label class="col-lg-5 col-xl-3 control-label text-lg-end mb-0">Longitude</label>
													<div class="col-lg-7 col-xl-6">
														<input id="eventLongitude" type="text" class="form-control form-control-modern" name="longitude" value="" required />
													</div>
												</div>
												<div class="form-group row align-items-center pb-3">
													<label class="col-lg-5 col-xl-3 control-label text-lg-end mb-0">Image</label>
													<div class="col-lg-7 col-xl-6">
														<input id="eventImage" type="text" class="form-control form-control-modern" name="eventImage" value="" required />
													</div>
												</div>
											</div>
										</div>
									</div>
								</section>

								<script>
									$(document).ready(function() {
										// Parse the event id from the url
										const urlParams = new URLSearchParams(window.location.search);
										const eventId = urlParams.get('id');

										$.ajax({
											url: `/eventList/${eventId}`, // fetch data for specific event
											method: "GET",
											success: function(event) {
												// Populate the form with the event data
												$('#eventName').val(event.eventName);
												$('#eventDescription').val(event.eventDescription);

												const eventDate = new Date(event.eventDate);
												$('#eventDate').val(eventDate.toISOString().split('T')[0]); // YYYY-MM-DD format
												$('#eventHour').val(eventDate.getHours());
												$('#eventMinute').val(eventDate.getMinutes());

												$('#eventLatitude').val(event.eventCoordinates.lat);
												$('#eventLongitude').val(event.eventCoordinates.long);
												$('#eventImage').val(event.eventImage);
											}
										});
									});
								</script>

							</div>
						</div>


						<div class="row action-buttons">
							<div class="col-12 col-md-auto">
								<button id="saveEventBtn" type="submit" class="submit-button btn btn-primary btn-px-4 py-3 d-flex align-items-center font-weight-semibold line-height-1" data-loading-text="Loading...">
									<i class="bx bx-save text-4 me-2"></i> Save Event
								</button>
							</div>
							<div class="col-12 col-md-auto px-md-0 mt-3 mt-md-0">
								<a href="page-admin-event-list.html" class="cancel-button btn btn-light btn-px-4 py-3 border font-weight-semibold text-color-dark text-3">Cancel</a>
							</div>
							<div class="col-12 col-md-auto ms-md-auto mt-3 mt-md-0 ms-auto">
								<a id="deleteEventBtn" href="#" class="delete-button btn btn-danger btn-px-4 py-3 d-flex align-items-center font-weight-semibold line-height-1">
									<i class="bx bx-trash text-4 me-2"></i> Delete Event
								</a>
							</div>
						</div>
					</form>
					<!-- end: page -->
					<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>

					<script>
						$(document).ready(function() {
							const urlParams = new URLSearchParams(window.location.search);
							const eventId = urlParams.get('id');

							$('#saveEventBtn').click(async function(e) {
								e.preventDefault();

								const event = {
									eventName: $('#eventName').val(),
									eventDescription: $('#eventDescription').val(),
									eventDate: new Date($('#eventDate').val() + ' ' + $('#eventHour').val() + ':' + $('#eventMinute').val()).toISOString(),
									eventCoordinates: {
										lat: parseFloat($('#eventLatitude').val()),
										long: parseFloat($('#eventLongitude').val())
									}
								};

								const response = await fetch('/eventList/' + eventId, {
									method: 'PUT',
									headers: {
										'Content-Type': 'application/json'
									},
									body: JSON.stringify(event)
								});

								if (response.ok) {
									Swal.fire(
											'Saved!',
											'Event saved successfully.',
											'success'
									);
								} else {
									Swal.fire(
											'Error!',
											'An error occurred while saving the event.',
											'error'
									);
								}
							});

							$('#deleteEventBtn').click(async function(e) {
								e.preventDefault();

								const confirmed = await Swal.fire({
									title: 'Are you sure?',
									text: "You won't be able to revert this!",
									icon: 'warning',
									showCancelButton: true,
									confirmButtonColor: '#3085d6',
									cancelButtonColor: '#d33',
									confirmButtonText: 'Yes, delete it!'
								});

								if (confirmed.isConfirmed) {
									const response = await fetch('/eventList/' + eventId, {
										method: 'DELETE'
									});

									if (response.ok) {
										Swal.fire(
												'Deleted!',
												'Event deleted successfully.',
												'success'
										).then(() => {
											window.location.href = 'page-admin-event-list.html';
										});
									} else {
										Swal.fire(
												'Error!',
												'An error occurred while deleting the event.',
												'error'
										);
									}
								}
							});
						});
					</script>

				</section>
			</div>

		</section>

		<!-- Vendor -->
		<script src="vendor/jquery/jquery.js"></script>
		<script src="vendor/jquery-browser-mobile/jquery.browser.mobile.js"></script>
		<script src="vendor/popper/umd/popper.min.js"></script>
		<script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
		<script src="vendor/bootstrap-datepicker/js/bootstrap-datepicker.js"></script>
		<script src="vendor/common/common.js"></script>
		<script src="vendor/nanoscroller/nanoscroller.js"></script>
		<script src="vendor/magnific-popup/jquery.magnific-popup.js"></script>
		<script src="vendor/jquery-placeholder/jquery.placeholder.js"></script>

		<!-- Specific Page Vendor -->
		<script src="vendor/select2/js/select2.js"></script>

		<!-- Theme Base, Components and Settings -->
		<script src="js/theme.js"></script>

		<!-- Theme Custom -->
		<script src="js/custom.js"></script>

		<!-- Theme Initialization Files -->
		<script src="js/theme.init.js"></script>

		<!-- Examples -->
		<script src="js/examples/examples.header.menu.js"></script>
		<script src="js/examples/examples.ecommerce.orders.detail.js"></script>

	</body>
</html>